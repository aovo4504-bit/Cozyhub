<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CozyHub Key</title>

<style>
    body {
        margin: 0;
        font-family: 'Poppins', sans-serif;
        background: #020817;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        overflow: hidden;
    }

    .stars {
        position: absolute;
        inset: 0;
        background: url('https://raw.githubusercontent.com/aovo4504-bit/Cozyhub/main/starsbg.gif');
        background-size: cover;
        z-index: -1;
    }

    .card {
        background: rgba(0, 0, 0, 0.55);
        padding: 40px;
        width: 420px;
        border-radius: 22px;
        text-align: center;
        box-shadow: 0 0 55px #00eaff;
    }

    .logo {
        width: 130px;
        height: 130px;
        margin: 0 auto 20px;
        border-radius: 50%;
        background: url('https://raw.githubusercontent.com/aovo4504-bit/Cozyhub/refs/heads/main/IMG_0830.png') center/cover;
        box-shadow: 0 0 35px #00eaff, 0 0 60px #00eaff;
    }

    h1 {
        color: #00eaff;
        text-shadow: 0 0 15px #00eaff;
        margin-bottom: 20px;
        font-size: 28px;
    }

    .loader {
        border: 6px solid #0e1e28;
        border-top: 6px solid #00eaff;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        margin: 0 auto 15px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .status {
        margin-top: 10px;
        font-size: 14px;
        opacity: 0.85;
    }

    .keybox {
        margin-top: 20px;
        padding: 14px;
        background: #000;
        border-radius: 12px;
        box-shadow: inset 0 0 25px #00eaff;
        font-size: 20px;
        min-height: 28px;
        word-break: break-all;
        letter-spacing: 1px;
        opacity: 0;
        transition: 0.4s;
    }
    .keybox.show { opacity: 1; }

    .copy-btn {
        margin-top: 15px;
        background: #00eaff;
        padding: 14px;
        border-radius: 10px;
        width: 100%;
        border: none;
        font-weight: bold;
        font-size: 16px;
        cursor: pointer;
        opacity: 0;
        transition: 0.4s;
    }
    .copy-btn.show { opacity: 1; }

    .msg {
        margin-top: 12px;
        font-size: 14px;
        transition: 0.3s;
    }
    .msg.ok { color: #59ff91; }
    .msg.error { color: #ff4d4d; }
</style>
</head>

<body>

<div class="stars"></div>

<div class="card">

    <div class="logo"></div>

    <h1>CozyHub Key</h1>

    <div class="loader"></div>
    <div class="status" id="status">Đang lấy key...</div>

    <div class="keybox" id="key">...</div>

    <button class="copy-btn" id="copyBtn" onclick="copyKey()">COPY KEY</button>

    <div class="msg" id="msg"></div>
</div>

<script>
const API_URL = "https://YOUR_WORKER_URL";   // ← THAY BẰNG WORKER API CỦA BẠN

const keyBox = document.getElementById("key");
const msg = document.getElementById("msg");
const status = document.getElementById("status");
const btn = document.getElementById("copyBtn");

const lang = (navigator.language || "en").startsWith("vi") ? "vi" : "en";
const TEXT = {
    loading: { vi: "Đang lấy key...", en: "Fetching key..." },
    got_new: { vi: "Tạo key mới thành công!", en: "New key generated!" },
    got_old: { vi: "Bạn đã lấy key rồi (còn hạn).", en: "You already have a valid key." },
    expire: { vi: "Key hết hạn lúc: ", en: "Expires at: " },
    copied: { vi: "Đã copy!", en: "Copied!" },
    error: { vi: "Lỗi server, thử lại sau!", en: "Server error, try again!" }
};

status.textContent = TEXT.loading[lang];

// FETCH KEY FROM API
async function loadKey() {
    try {
        const res = await fetch(API_URL + "/claim");
        const data = await res.json();

        if (!data.key) throw 0;

        keyBox.textContent = data.key;
        keyBox.classList.add("show");

        btn.classList.add("show");

        const exp = new Date(data.expire).toLocaleString();
        msg.textContent = TEXT.expire[lang] + exp;
        msg.classList.add("ok");

        status.textContent = data.reused
            ? TEXT.got_old[lang]
            : TEXT.got_new[lang];

    } catch (e) {
        keyBox.textContent = "ERROR";
        keyBox.classList.add("show");
        msg.textContent = TEXT.error[lang];
        msg.classList.add("error");
        status.textContent = TEXT.error[lang];
    }
}
loadKey();

function copyKey() {
    const key = keyBox.textContent.trim();
    if (!key || key === "ERROR") return;

    navigator.clipboard.writeText(key);
    msg.textContent = TEXT.copied[lang];
    msg.className = "msg ok";
}
</script>

</body>
</html>
